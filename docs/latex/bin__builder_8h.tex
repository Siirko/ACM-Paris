\hypertarget{bin__builder_8h}{}\doxysection{include/bin\+\_\+builder.h File Reference}
\label{bin__builder_8h}\index{include/bin\_builder.h@{include/bin\_builder.h}}
{\ttfamily \#include \char`\"{}array\+\_\+list.\+h\char`\"{}}\newline
Include dependency graph for bin\+\_\+builder.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{bin__builder_8h_a3dc244c07dbb044c301d271d33c4d4ab}{sanatize\+\_\+coordinates}} (double $\ast$lattitude, double $\ast$longitude, char $\ast$coordinates)
\item 
int \mbox{\hyperlink{bin__builder_8h_a528166af3c3443fac3607ca2d0281602}{write\+\_\+to\+\_\+csv\+\_\+bin}} (char $\ast$$\ast$str, FILE $\ast$fp, int n)
\item 
int \mbox{\hyperlink{bin__builder_8h_a9740c6a3456e81349f44221bf6f1a099}{build\+\_\+csv\+\_\+bin}} (FILE $\ast$fp, char $\ast$path\+\_\+bin, char delimiter)
\item 
\mbox{\hyperlink{array__list_8h_a15376354e4e8b4f1732e9df17f30786c}{list\+\_\+t}} $\ast$ \mbox{\hyperlink{bin__builder_8h_a72af491dba4bd97700b63f8dc347d767}{get\+\_\+data\+\_\+csv\+\_\+bin}} (FILE $\ast$fp)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{bin__builder_8h_a9740c6a3456e81349f44221bf6f1a099}\label{bin__builder_8h_a9740c6a3456e81349f44221bf6f1a099}} 
\index{bin\_builder.h@{bin\_builder.h}!build\_csv\_bin@{build\_csv\_bin}}
\index{build\_csv\_bin@{build\_csv\_bin}!bin\_builder.h@{bin\_builder.h}}
\doxysubsubsection{\texorpdfstring{build\_csv\_bin()}{build\_csv\_bin()}}
{\footnotesize\ttfamily int build\+\_\+csv\+\_\+bin (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{fp,  }\item[{char $\ast$}]{path\+\_\+bin,  }\item[{char}]{delimiter }\end{DoxyParamCaption})}

Build binary file from fp that represent a csv file, saved to path\+\_\+bin 
\begin{DoxyParams}{Parameters}
{\em fp} & \\
\hline
{\em path\+\_\+bin} & \\
\hline
{\em delimiter} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if done it succesfuly, otherwise 0 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
fp is not closed into this function. 

delimiter is by default \textquotesingle{};\textquotesingle{} 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{58                                                            \{}
\DoxyCodeLine{59     FILE* fp\_bin = fopen(path\_bin, \textcolor{stringliteral}{"{}w+b"{}});}
\DoxyCodeLine{60     \textcolor{keywordflow}{if}(fp\_bin == NULL)\{ perror(\textcolor{stringliteral}{"{}failed to fopen to path\_bin\(\backslash\)n"{}}); \textcolor{keywordflow}{return} EXIT\_FAILURE; \}}
\DoxyCodeLine{61     \textcolor{comment}{// Get the number of column by counting how much delimter there are in the header}}
\DoxyCodeLine{62     \textcolor{keywordtype}{int} n = \mbox{\hyperlink{csv__parser_8c_a6bc0f81692cf5d8b837380bbb96b82f4}{size\_column}}(fp, delimiter);}
\DoxyCodeLine{63     \textcolor{keywordflow}{if}(n == 0)\{}
\DoxyCodeLine{64         \mbox{\hyperlink{cprintf_8c_abaf6f449289ba2ab499573103e32ec2d}{eprintf}}(\textcolor{stringliteral}{"{}column of file is empty, delimiter problem maybe?\(\backslash\)n"{}}); }
\DoxyCodeLine{65         \textcolor{keywordflow}{return} EXIT\_FAILURE; }
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67     \textcolor{comment}{// Skip header (first line)}}
\DoxyCodeLine{68     \mbox{\hyperlink{csv__parser_8c_a128a04a2edc9c702b876cb1d8c23f74e}{skip\_header}}(fp);}
\DoxyCodeLine{69     \textcolor{comment}{// check if we are at the end of the file}}
\DoxyCodeLine{70     \textcolor{keywordflow}{if}(feof(fp))\{}
\DoxyCodeLine{71         \mbox{\hyperlink{cprintf_8c_abaf6f449289ba2ab499573103e32ec2d}{eprintf}}(\textcolor{stringliteral}{"{}end of file, your file is maybe empty.\(\backslash\)n"{}});}
\DoxyCodeLine{72         \textcolor{keywordflow}{return} EXIT\_FAILURE;}
\DoxyCodeLine{73     \}}
\DoxyCodeLine{74     \textcolor{comment}{// check if next line is empty}}
\DoxyCodeLine{75     \textcolor{keywordflow}{if}(\mbox{\hyperlink{bin__builder_8c_a18afdb04b391d886f6f9305aa7281eb9}{is\_empty\_line}}(fp))\{}
\DoxyCodeLine{76         \mbox{\hyperlink{cprintf_8c_abaf6f449289ba2ab499573103e32ec2d}{eprintf}}(\textcolor{stringliteral}{"{}line is empty\(\backslash\)n"{}});}
\DoxyCodeLine{77         \textcolor{keywordflow}{return} EXIT\_FAILURE;}
\DoxyCodeLine{78     \}}
\DoxyCodeLine{79     \textcolor{keywordtype}{char}** contents;  }
\DoxyCodeLine{80     \textcolor{keywordflow}{while}((contents = \mbox{\hyperlink{csv__parser_8c_a97192f08585d44747acd721a61839330}{get\_line}}(fp, n, delimiter)) != NULL)\{ }
\DoxyCodeLine{81         \textcolor{keywordflow}{if}(\mbox{\hyperlink{bin__builder_8c_a4049baa165aaf59a7374b2a1eb72bbf4}{write\_to\_csv\_bin}}(contents, fp\_bin, n) == EXIT\_FAILURE) \{ }
\DoxyCodeLine{82             \mbox{\hyperlink{cprintf_8c_abaf6f449289ba2ab499573103e32ec2d}{eprintf}}(\textcolor{stringliteral}{"{}Failed to write to file\(\backslash\)n"{}});}
\DoxyCodeLine{83             fclose(fp\_bin);}
\DoxyCodeLine{84             \mbox{\hyperlink{csv__parser_8c_a81b03303498e5ea89a90f90da6bc69a2}{exterminate\_malloc}}(contents, n); }
\DoxyCodeLine{85             \textcolor{keywordflow}{return} EXIT\_FAILURE;}
\DoxyCodeLine{86         \}}
\DoxyCodeLine{87         \mbox{\hyperlink{csv__parser_8c_a81b03303498e5ea89a90f90da6bc69a2}{exterminate\_malloc}}(contents, n);}
\DoxyCodeLine{88     \}}
\DoxyCodeLine{89     fclose(fp\_bin);}
\DoxyCodeLine{90     \textcolor{keywordflow}{return} EXIT\_SUCCESS;}
\DoxyCodeLine{91 \}}

\end{DoxyCode}
\mbox{\Hypertarget{bin__builder_8h_a72af491dba4bd97700b63f8dc347d767}\label{bin__builder_8h_a72af491dba4bd97700b63f8dc347d767}} 
\index{bin\_builder.h@{bin\_builder.h}!get\_data\_csv\_bin@{get\_data\_csv\_bin}}
\index{get\_data\_csv\_bin@{get\_data\_csv\_bin}!bin\_builder.h@{bin\_builder.h}}
\doxysubsubsection{\texorpdfstring{get\_data\_csv\_bin()}{get\_data\_csv\_bin()}}
{\footnotesize\ttfamily \mbox{\hyperlink{array__list_8h_a15376354e4e8b4f1732e9df17f30786c}{list\+\_\+t}}$\ast$ get\+\_\+data\+\_\+csv\+\_\+bin (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{fp }\end{DoxyParamCaption})}

Read and deserialize binary file from fp that represent a csv file, and return a list of theses data. 
\begin{DoxyParams}{Parameters}
{\em fp} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
list of data\+\_\+t 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
fp is not closed into this function. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{93                                   \{}
\DoxyCodeLine{94     \textcolor{keywordtype}{char} \mbox{\hyperlink{structdata}{data}}[\textcolor{keyword}{sizeof}(\mbox{\hyperlink{data__t_8h_a1d756f237acef91aa7ef4e6b87f52632}{data\_t}})];}
\DoxyCodeLine{95     \mbox{\hyperlink{structlist}{list\_t}}* data\_list = \mbox{\hyperlink{array__list_8c_af609c5d27a13835d2ced6efb86c30881}{list\_create}}();}
\DoxyCodeLine{96     \textcolor{keywordflow}{while}(fread(\mbox{\hyperlink{structdata}{data}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdata}{data\_t}}), 1, fp))\{}
\DoxyCodeLine{97         \mbox{\hyperlink{structdata}{data\_t}}* d = \mbox{\hyperlink{data__t_8c_a9ac0ddfa3bd075ef903ea5a2cd387669}{deserialize\_data\_t}}(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{98         \mbox{\hyperlink{array__list_8c_a9cc2239b9511cd65ec4ea14ee7e9c6c7}{list\_append}}(data\_list, d);}
\DoxyCodeLine{99     \}}
\DoxyCodeLine{100     \textcolor{keywordflow}{return} data\_list;}
\DoxyCodeLine{101 \}}

\end{DoxyCode}
\mbox{\Hypertarget{bin__builder_8h_a3dc244c07dbb044c301d271d33c4d4ab}\label{bin__builder_8h_a3dc244c07dbb044c301d271d33c4d4ab}} 
\index{bin\_builder.h@{bin\_builder.h}!sanatize\_coordinates@{sanatize\_coordinates}}
\index{sanatize\_coordinates@{sanatize\_coordinates}!bin\_builder.h@{bin\_builder.h}}
\doxysubsubsection{\texorpdfstring{sanatize\_coordinates()}{sanatize\_coordinates()}}
{\footnotesize\ttfamily void sanatize\+\_\+coordinates (\begin{DoxyParamCaption}\item[{double $\ast$}]{lattitude,  }\item[{double $\ast$}]{longitude,  }\item[{char $\ast$}]{coordinates }\end{DoxyParamCaption})}

Sanatize coordinates that are in form of \char`\"{}lattitude,longitude\char`\"{} 
\begin{DoxyParams}{Parameters}
{\em lattitude} & \\
\hline
{\em longitude} & \\
\hline
{\em coordinates} & \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{12                                                                                   \{}
\DoxyCodeLine{13     \textcolor{keywordtype}{char}* endPtr;}
\DoxyCodeLine{14     \textcolor{keywordtype}{char}* checkPtr;}
\DoxyCodeLine{15     *lattitude = strtod(coordinates, \&endPtr);}
\DoxyCodeLine{16     \textcolor{comment}{// Remove "{},"{}"{} because the data is in form "{}x,y"{}}}
\DoxyCodeLine{17     memmove(\&endPtr[0], \&endPtr[0 + 1], strlen(endPtr) -\/ 0);}
\DoxyCodeLine{18     *longitude = strtod(endPtr, \&checkPtr);}
\DoxyCodeLine{19     \textcolor{comment}{// check if the conversion was successful}}
\DoxyCodeLine{20     \textcolor{keywordflow}{if}(strcmp(checkPtr, endPtr) == 0)\{}
\DoxyCodeLine{21         \mbox{\hyperlink{cprintf_8c_abaf6f449289ba2ab499573103e32ec2d}{eprintf}}(\textcolor{stringliteral}{"{}Failed to convert coordinates to double\(\backslash\)n(coordinate must be the last element of the line in form of \(\backslash\)"{}x,y\(\backslash\)"{} !)\(\backslash\)n"{}});}
\DoxyCodeLine{22         exit(EXIT\_FAILURE);}
\DoxyCodeLine{23     \}}
\DoxyCodeLine{24 \}}

\end{DoxyCode}
\mbox{\Hypertarget{bin__builder_8h_a528166af3c3443fac3607ca2d0281602}\label{bin__builder_8h_a528166af3c3443fac3607ca2d0281602}} 
\index{bin\_builder.h@{bin\_builder.h}!write\_to\_csv\_bin@{write\_to\_csv\_bin}}
\index{write\_to\_csv\_bin@{write\_to\_csv\_bin}!bin\_builder.h@{bin\_builder.h}}
\doxysubsubsection{\texorpdfstring{write\_to\_csv\_bin()}{write\_to\_csv\_bin()}}
{\footnotesize\ttfamily int write\+\_\+to\+\_\+csv\+\_\+bin (\begin{DoxyParamCaption}\item[{char $\ast$$\ast$}]{str,  }\item[{FILE $\ast$}]{fp,  }\item[{int}]{n }\end{DoxyParamCaption})}

Write serialized data to fp. Return 1 if done it successfuly, otherwise 0. fp is not closed into this function. 
\begin{DoxyParams}{Parameters}
{\em str} & \\
\hline
{\em fp} & \\
\hline
{\em n} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if done it successfuly, otherwise 0 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
fp is not closed into this function. 
\end{DoxyNote}

\begin{DoxyCode}{0}
\DoxyCodeLine{26                                                           \{}
\DoxyCodeLine{27     \textcolor{keywordtype}{double} lattitude, longitude;}
\DoxyCodeLine{28     \textcolor{keyword}{static} \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{29     \mbox{\hyperlink{bin__builder_8c_a3dc244c07dbb044c301d271d33c4d4ab}{sanatize\_coordinates}}(\&lattitude, \&longitude, contents[n-\/1]);}
\DoxyCodeLine{30     \textcolor{keywordtype}{char}* \mbox{\hyperlink{structdata}{data}} = \mbox{\hyperlink{data__t_8c_a90cc88c6f5c2c459ed1b481aa3f05b70}{serialize\_data\_t}}(lattitude,longitude, i);}
\DoxyCodeLine{31     \textcolor{keywordflow}{if}(fwrite(\mbox{\hyperlink{structdata}{data}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdata}{data\_t}}), 1, fp\_bin) != 1)\{}
\DoxyCodeLine{32         perror(\textcolor{stringliteral}{"{}Failed to write to file\(\backslash\)n"{}});}
\DoxyCodeLine{33         \textcolor{keywordflow}{return} EXIT\_FAILURE;}
\DoxyCodeLine{34     \}}
\DoxyCodeLine{35     free(\mbox{\hyperlink{structdata}{data}});}
\DoxyCodeLine{36     i++;}
\DoxyCodeLine{37     \textcolor{keywordflow}{return} EXIT\_SUCCESS;}
\DoxyCodeLine{38 \}}

\end{DoxyCode}
